# Base

## Analisi statica

### Servizi esterni

+ Calcolare hash del file
+ In altervativa, upload del file

- VirusTotal
    - il malware è già stato analizzato?


### File PE

- Ricerca di Stringhe
    - sono stati usati packer?
    - quali stringhe utili troviamo?
- Import\Export
    - quali sono gli import?
    - quali sono gli export?
    - è possibile tracciare a grandi linee il comportamento o parte di esso del malware?
- Quando è stato compilato il file?
- Ci sono sezioni sospette?
    - I nomi delle sezioni sono "standard"?
    - La differenza tra la VirtualSize e la RawSize suggerisce la presenza di un packer/unpacker?
    - Il subsytem indica che il malware è eseguito tramite GUI o CUI?

## Analisi dinamica

### DLL

- Analisi della DLL
    - ci sono export utilizzabili?
    - richiede l'installazione come servizio?
        - il servizio si avvia in automatico? Se si avvia manualmente cosa succede?
- Uso della DLL
    - quali processi ne fanno uso?

### Processi

- Analisi del processo
    - il file .exe in quale cartella si trova?
    - con quale comando e parametri è stato lanciato?
    - il file .exe richiede accetta altri parametri?
    - si tratta di un file verificato?
    - una volta caricato in memoria, la lista delle stringhe leggibili cambia?
    - da quali altre risorse dipende il processo?
    - modifiche a livello di filesystem come la crezione di file?

### Registro di sistema

- Analisi delle registro di sistema
    - differenze tra gli snapshot?
    - - quali chiave/valori sono modificati e/o aggiunti?

### Rete

- Analisi della rete
    - il malware cerca di comunicare con l'esterno?
    - quali richieste DNS esegue?
    - quali indirizzi IP contatta?
    - quali porte e protocolli?
            - il malware fa uso di protocolli custom?
    - è possibile intercettare le richieste, ad esempio reindirizzando verso un netcat locale?
    - l'analisi del file PCAP della cattura rivela ulteriori informazioni?


# Avanzata

- Analisi degli Import
    - quali sono gli Import interessanti?
        - quante funzioni chiamano l'Import in oggetto?
        - quanti e quali sono i parametri usati?
        
- Analisi degli Export

- Analisi del disassemblato
    - quali funzioni sono state individuate e rinominate?
    - è possibile definire il comportamento del malware più nel dettaglio?

- Analisi delle Windows API
    - come il malware ottiene persistenza nel sistema?
    - quali processi crea?
    - ci sono manipolazioni di file o cartelle?
    - sono modificate chiavi o valori nel registro di sistema?
    - vengono effettuate operazioni a livello di rete?

- Mutexes e oggetti COM
    - quali mutex usa il malware?
    - perché ne fa uso?

    - quali COM usa il malware?
        - quali CLSID? a cosa corrisponde? (`HKEY_CLASSES_ROOT\CLSID`)

# Conclusioni

- Qual è il comportamento del malware?
- Quali artefatti di sistema risultano dall'analisi?
- Quali artefatti di rete risultano dall'analisi?